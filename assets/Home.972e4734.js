import{r as d,j as m,b as t,a as H,F as b,H as k,L as C}from"./index.5a5de3aa.js";import{T as c,p as N,g as S}from"./tasks.service.073332af.js";const E={width:0,height:0,halfWidth:0,halfHeight:0};function T(i){const{data:o}=i,s=d.exports.useRef(null),[u,e]=d.exports.useState(E),[h,l]=d.exports.useState(""),g=r=>{r.dataTransfer.setData("text/plain",o.id),r.dataTransfer.effectAllowed="move",setTimeout(()=>{var n;(n=s.current)==null||n.classList.add("hide")},0)},f=r=>{r.preventDefault(),r.stopPropagation();const n=r.nativeEvent.offsetX,v=r.nativeEvent.offsetY,D=18,L=(n-u.halfWidth)/u.halfWidth*D,$=(v-u.halfHeight)/u.halfHeight*D;l(`rotateX(${L}deg) rotateY(${$}deg)`)},p=()=>{l("")},a=r=>{var n;(n=s.current)==null||n.classList.remove("hide")};return d.exports.useEffect(()=>{const{width:r,height:n}=s.current.getBoundingClientRect();e({width:r,height:n,halfWidth:r/2,halfHeight:n/2})},[]),m("div",{id:o.id,className:"card-container",onDragStart:g,onDragEnd:a,draggable:!0,onMouseMove:f,onMouseLeave:p,ref:s,style:{transform:h},children:[t("div",{className:"card-title",children:t("h2",{children:o.title})}),t("div",{className:"card-body",children:t("p",{children:o.body})}),t("div",{className:"card-footer",children:m("p",{children:[o.author," - ",o.createdAt]})})]})}function x(i){const{id:o,title:s,color:u,children:e}=i;return m("div",{id:o,style:{backgroundColor:u},className:"column-container",children:[t("div",{className:"column-title",children:s}),t("div",{className:"column-body",children:e})]})}function y(i){const o=H(a=>a.auth.authData),[s,u]=d.exports.useState(i.kanbanTasks),[e,h]=d.exports.useState(null),l="droppable",g=a=>{a.preventDefault(),a.dataTransfer&&a.dataTransfer.types[0]==="text/plain"&&e!==+a.currentTarget.id.replace("column-","")&&(console.log(a),h(+a.currentTarget.id.replace("column-","")),console.log("DRAGOVERHANDLER....."))},f=a=>{a.preventDefault();const r=a.dataTransfer.getData("text/plain"),n=s.filter(D=>D.id==r);if(n[0].status===e){h(null);return}console.log("dropHandler:"),console.log(`dropped: task with id: ${r} in ${a.currentTarget.id}`),console.log(a),console.log("..........");const v=o.token;console.log({patchedTask:n}),n[0].status=e!=null?e:0,N(n[0],v),h(null)},p=a=>{a.preventDefault(),console.log("DragLeave")};return m("div",{className:"kanban-container",children:[t(x,{id:"x0",title:"To Do",color:"#FDC974",children:t("div",{id:`column-${c.todo}`,className:`column-item todo-container ${e===c.todo?l:""}`,onDragOver:g,onDrop:f,onDragLeave:p,children:s.map(a=>{if(a.status===c.todo)return t(T,{data:a},a.id)})})}),t(x,{id:"x1",title:"Doing",color:"#f98468",children:t("div",{id:`column-${c.doing}`,className:`column-item todo-container ${e===c.doing?l:""}`,onDragOver:g,onDrop:f,onDragLeave:p,children:s.map(a=>{if(a.status===c.doing)return t(T,{data:a},a.id)})})}),t(x,{id:"x3",title:"Done",color:"#fa3463",children:t("div",{id:`column-${c.done}`,className:`column-item todo-container ${e===c.done?l:""}`,onDragOver:g,onDrop:f,onDragLeave:p,children:s.map(a=>{if(a.status===c.done)return t(T,{data:a},a.id)})})}),e!==null&&t("div",{className:`trash-container ${e===c.deleted?l:""}`,id:`column-${c.deleted}`,onDragOver:g,onDrop:f,onDragLeave:p})]})}function A(){const i=H(l=>l.auth.authData),[o,s]=d.exports.useState([]),[u,e]=d.exports.useState(!0),h=d.exports.useCallback(async()=>{const l=await S(i.token);console.log("useTasks()"),console.log(l),s(l),e(!1)},[]);return d.exports.useEffect(()=>{h()},[h]),[o,u]}function w(){console.log("rendering Home...");const[i,o]=A();return m(b,{children:[t(k,{children:t("title",{children:"Kanban App - Home"})}),o?m(b,{children:[t(k,{children:t("title",{children:"Kanban App - Loading..."})}),t(C,{})]}):t("div",{children:t(y,{kanbanTasks:i})})]})}export{w as default};
